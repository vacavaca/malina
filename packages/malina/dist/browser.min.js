(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports):typeof define==="function"&&define.amd?define(["exports"],t):t(e.malina={})})(this,function(e){"use strict";function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return t={exports:{}},e(t,t.exports),t.exports}var H=r(function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r=function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}if(r.length===0)return function(e){return e};if(r.length===1)return r[0];return r.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})};var v=function e(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))};var n=function e(t,r){if(t===r)return true;if(t==null!==(r==null))return false;if(t==null)return true;var n=v(t);var i=n.length;if(v(r).length!==i)return false;var a=true;var o=false;var s=undefined;try{for(var u=n[Symbol.iterator](),l;!(a=(l=u.next()).done);a=true){var f=l.value;if(t[f]!==r[f])return false}}catch(e){o=true;s=e}finally{try{if(!a&&u.return!=null){u.return()}}finally{if(o){throw s}}}return true};var i=function e(t,r){var n={};var i={};var a=t.length;var o=0;while(o<a){i[t[o]]=true;o+=1}var s=true;var u=false;var l=undefined;try{for(var f=v(r)[Symbol.iterator](),c;!(s=(c=f.next()).done);s=true){var h=c.value;if(!(h in i))n[h]=r[h]}}catch(e){u=true;l=e}finally{try{if(!s&&f.return!=null){f.return()}}finally{if(u){throw l}}}return n};var a=function e(t){var r=[];var n=t.length;var i=0;while(i<n){if(Array.isArray(t[i])){var a=e(t[i]);var o=a.length;var s=0;while(s<o){r[r.length]=a[s];s+=1}}else r[r.length]=t[i];i+=1}return r};function o(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function s(e){return u(e)||l(e)||f()}function u(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function l(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var c="-";var h=function e(t,r){if(r!=null)return"".concat(t).concat(c).concat(r);else return t};var d=function e(t){if(Array.isArray(t))return t.reduce(function(e,t){return o({},t,true)},{});else if(typeof t==="string")return e(t.split(" "));else return t};var y=function e(t,r){return[t].concat(s(Object.keys(r).filter(function(e){return!!r[e]}).map(function(e){return"".concat(t).concat(c.repeat(2)).concat(e)}))).filter(function(e){return!!e}).join(" ")};var m=function e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++){n[i-1]=arguments[i]}if(n.length===1){var a=n[0];if(typeof a==="string")return h(t,a);else return y(t,d(a))}else if(n.length===2){var o=n[0],s=n[1];return y(h(t,o),d(s))}else throw new Error("Unrecognized arguments")};var p=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}if(t.length===1){var n=t[0];return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return m.apply(void 0,[n].concat(t))}}else return m.apply(void 0,t)};t.classNames=p;t.cn=p;t.compose=r;t.keys=v;t.shallowEqual=n;t.omit=i;t.flatten=a});t(H);var n=H.classNames;var i=H.cn;var a=H.compose;var o=H.keys;var s=H.shallowEqual;var u=H.omit;var l=H.flatten;var f=r(function(e,t){Object.defineProperty(t,"__esModule",{value:true});function y(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){y=function(e){return typeof e}}else{y=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return y(e)}function u(e,t,r,n,i,a,o){try{var s=e[a](o);var u=s.value}catch(e){r(e);return}if(s.done){t(u)}else{Promise.resolve(u).then(n,i)}}function f(s){return function(){var e=this,o=arguments;return new Promise(function(t,r){var n=s.apply(e,o);function i(e){u(n,t,r,i,a,"next",e)}function a(e){u(n,t,r,i,a,"throw",e)}i(undefined)})}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function r(e,t,r){if(t)n(e.prototype,t);if(r)n(e,r);return e}function i(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function c(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};var n=Object.keys(r);if(typeof Object.getOwnPropertySymbols==="function"){n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))}n.forEach(function(e){i(t,e,r[e])})}return t}function k(e,t){return o(e)||h(e,t)||d()}function A(e){return a(e)||s(e)||v()}function a(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function o(e){if(Array.isArray(e))return e}function s(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function h(e,t){var r=[];var n=true;var i=false;var a=undefined;try{for(var o=e[Symbol.iterator](),s;!(n=(s=o.next()).done);n=true){r.push(s.value);if(t&&r.length===t)break}}catch(e){i=true;a=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(i)throw a}}return r}function v(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var m=function e(t,r,n,i){l(this,e);this.template=t;this.state=r;this.actions=n;this.hooks=i};var p=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;return new m(t instanceof Function?t:function(){return t},r,n,i)};var w=function(){function n(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];l(this,n);if(e==null)throw new Error("JSX tag empty ");this.tag=e;this.attrs=t;this.children=r}r(n,[{key:"toString",value:function e(){var t=typeof this.tag==="string"?this.tag:"View";return"".concat(t," ").concat(JSON.stringify(this.attrs||{})).concat(this.children.length>0?"\n".concat(this.children.map(function(e){if(e==null)return"\t''";var t=e.toString();return t.split("\n").map(function(e){return"\t".concat(e)}).join("\n")}).join("\n")):"")}}]);return n}();var N=function e(t){return t instanceof w&&t.tag instanceof m};var E=function e(t){return t instanceof w&&!N(t)};var g=function e(t){return typeof t==="string"};var b=function e(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++){i[a-2]=arguments[a]}var o=i.length===1&&Array.isArray(i[0])?i[0]:i;return new w(t,r,o)};var V=function e(t){return"on".concat(t[0].toUpperCase()).concat(t.substr(1))};var T=function e(t){var r=t.toLowerCase();return r.startsWith("on")?r.substr(2):r};var x=function e(t){var r=t.isSvg,n=r===void 0?false:r;l(this,e);this.isSvg=n};var S=function e(t){return Array.isArray(t)&&t.length===2&&t[0]instanceof Function};var P=function e(t,r){return S(t)&&S(r)&&t[0]===r[0]&&t[1]===r[1]};var L=false;var F=[];var I=new x({});var j=new x({isSvg:true});var O=function e(t){return t.length===0};var C=function e(t,r){return t.tag===r.tag};var z=function e(r){return r.every(function(e,t){return t===0||!N(e)||!N(r[t-1])||e.attrs.key||!C(e,r[t-1])})};var D=function(){function u(e,t){l(this,u);var r=e.tag,n=e.attrs,i=e.children;var a=r.state instanceof Function?r.state(n):r.state;var o=r.actions instanceof Function?r.actions(n):r.actions;var s=r.hooks instanceof Function?r.hooks(n):r.hooks;this.template=r.template;this.state=c({},a||{},n||{});this.actions=this.bindActions(o||{});this.children=i;this.hooks=s||{};this.renderingContext=t||I;this.templateLock=false;this.updateLock=false;this.element=null;this.node=null;this.innerViews=new Map;this.parametrizedEventListeners=new Map;this.scheduledActions=[];this.mounted=false;this.destroyed=false;this.trackedActionUpdate=false;this.container=this.callHook("create")}r(u,[{key:"mount",value:function e(t,r){var n=this;var i=t.ownerDocument;if(this.destroyed)return;var a=false;if(!L){L=true;a=true}var o=this.renderTemplate();if(Array.isArray(o))throw new Error("View can only have one root element");if(E(o)){if(o.tag==="svg")this.renderingContext=j;var s=this.mountNodeElement(t,r,o,[]);this.element=s}else if(N(o)){var u=this.instantiateInnerView(o,[]);u.mount(t,r);this.element=u.element}else{var l=i.createTextNode("".concat(o!=null?o:""));this.element=l;var f=t.childNodes[r]||null;t.insertBefore(l,f)}this.node=o;this.mounted=true;var c=true;var h=false;var v=undefined;try{for(var d=this.scheduledActions[Symbol.iterator](),y;!(c=(y=d.next()).done);c=true){var m=k(y.value,2),p=m[0],w=m[1];this.callAction.apply(this,[p].concat(A(w)))}}catch(e){h=true;v=e}finally{try{if(!c&&d.return!=null){d.return()}}finally{if(h){throw v}}}this.scheduledActions=[];if(a){for(var g=0;g<F.length;g++){var b=F[g];b()}this.callHook("mount");L=false}else F.push(function(){return n.callHook("mount")})}},{key:"update",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(this.destroyed)throw new Error("View has been destroyed");var n=this.updateState(t);var i=this.updateChildrenState(r);var e=this.state!==n||this.children!==i;this.state=n;this.children=i;if(this.mounted&&e){this.refresh();this.callHook("update")}return e}},{key:"refresh",value:function e(){var t=this.renderTemplate();var r=this.node;this.node=t;this.patch(this.element,r,t,[])}},{key:"unmount",value:function e(t){this.mounted=false;if(E(this.node))this.destroyInnerViews(this.node,[]);else if(N(this.node))this.destroyInnerView([]);if(t)this.element.remove();this.callHook("unmount");this.element=null}},{key:"destroy",value:function e(t){this.unmount(t);this.callHook("destroy");this.destroyed=true}},{key:"renderTemplate",value:function e(){this.templateLock=true;var t=this.template(this.state,this.actions,this.children);if(Array.isArray(t))throw new Error("Only one root element must be rendered for a view");t=t!=null?t:"";this.templateLock=false;return t}},{key:"bindActions",value:function e(i){var a=this;var r={};var t=true;var n=false;var o=undefined;try{var s=function e(){var n=l.value;var t=i[n];if(t instanceof Function)r[n]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return a.callAction.apply(a,[i[n]].concat(t))};else r[n]=a.bindActions(t)};for(var u=H.keys(i)[Symbol.iterator](),l;!(t=(l=u.next()).done);t=true){s()}}catch(e){n=true;o=e}finally{try{if(!t&&u.return!=null){u.return()}}finally{if(n){throw o}}}return r}},{key:"callAction",value:function e(t){var n=this;if(this.templateLock)throw new Error("Actions can't be called while rendering view template");for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++){i[a-1]=arguments[a]}if(this.mounted){var o=!this.updateLock;this.updateLock=true;var s=t.apply(void 0,i)(this.state,this.actions);if(s instanceof Promise){this.updateLock=false;if(this.trackedActionUpdate)this.refresh();this.trackedActionUpdate=false;return f(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function e(t){while(1){switch(t.prev=t.next){case 0:t.next=2;return s;case 2:r=t.sent;if(!n.destroyed)n.update(r);return t.abrupt("return",n.state);case 5:case"end":return t.stop()}}},e,this)}))()}else{if(o){if(!this.destroyed&&this.mounted){var u=this.update(s);if(!u&&this.trackedActionUpdate)this.refresh();this.trackedActionUpdate=false}else if(!this.destroyed)this.state=this.updateState(s)}else{var l=this.updateState(s);this.trackedActionUpdate=this.trackedActionUpdate||this.state!==l;this.state=l}this.updateLock=false;return this.state}}else this.scheduledActions.push([t,i])}},{key:"updateState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(t==null||t===this.state)return this.state;var r=t!==null?c({},this.state,t):this.state;return!H.shallowEqual(this.state,r)?r:this.state}},{key:"updateChildrenState",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(t===null||t===null)return this.children;var r=this.children==null||this.children.length===0;var n=t.length===0;if(r!==n)return t;else return!H.shallowEqual(this.children,t)?t:this.children}},{key:"callHook",value:function e(t){if(t in this.hooks)this.hooks[t](this.element,this.state,this.actions)}},{key:"patch",value:function e(t,r,n,i){if(r===n)return;if(E(r)){if(n==null)this.patchFromNodeToNone(t,r,i);else if(E(n))this.patchFromNodeToNode(t,r,n,i);else if(N(n))this.patchFromNodeToView(t,r,n,i);else this.patchFromNodeToText(t,r,n,i)}else if(N(r)){if(n==null)this.patchFromViewToNone(t,r,i);else if(E(n))this.patchFromViewToNode(t,r,n,i);else if(N(n))this.patchFromViewToView(t,r,n,i);else this.patchFromViewToText(t,r,n,i)}else{if(n==null)this.patchFromTextToNone(t,i);else if(E(n))this.patchFromTextToNode(t,n,i);else if(N(n))this.patchFromTextToView(t,n,i);else this.patchTextNodes(t,r,n,i)}}},{key:"patchFromTextToNone",value:function e(t,r){if(O(r))throw new Error("Root element deleted during patch");t.parentNode.removeChild(t)}},{key:"patchTextNodes",value:function e(t,r,n,i){if(r!==n){var a=t.ownerDocument.createTextNode("".concat(n));t.replaceWith(a);if(O(i))this.element=a}}},{key:"patchFromTextToNode",value:function e(t,r,n){var i=this.createNodeElement(t.ownerDocument,r,n);t.replaceWith(i);if(O(n))this.element=i}},{key:"patchFromTextToView",value:function e(t,r,n){var i=this.instantiateInnerView(r,n);var a=Array.from(t.parentNode.childNodes).findIndex(function(e){return e===t});var o=t.parentNode;t.remove();i.mount(o,a);if(O(n))this.element=i.element}},{key:"patchFromNodeToNone",value:function e(t,r,n){if(O(n))throw new Error("Root element deleted during patch");this.removeParametrizedListeners(r,n);this.destroyInnerViews(r,n);t.remove()}},{key:"patchFromNodeToText",value:function e(t,r,n,i){this.removeParametrizedListeners(r,i);this.destroyInnerViews(r,i);var a=t.ownerDocument.createTextNode("".concat(n));t.replaceWith(a);if(O(i))this.element=a}},{key:"patchFromNodeToNode",value:function e(t,r,n,i){if(r===n)return;if(r.tag===n.tag){this.updateAttributes(t,r,n,i);this.updateChildren(t,r,n,i)}else{this.removeParametrizedListeners(r,i);this.destroyInnerViews(r,i);var a=this.createNodeElement(t.ownerDocument,n,i);t.replaceWith(a);if(O(i))this.element=a}}},{key:"patchFromNodeToView",value:function e(t,r,n,i){this.removeParametrizedListeners(r,i);this.destroyInnerViews(r,i);var a=this.instantiateInnerView(n,i);var o=Array.from(t.parentNode.childNodes).findIndex(function(e){return e===t});var s=t.parentNode;t.remove();a.mount(s,o);if(O(i))this.element=a.element}},{key:"patchFromViewToNone",value:function e(t,r,n){if(O(n))throw new Error("Root element deleted during patch");this.destroyInnerView(n);t.remove()}},{key:"patchFromViewToText",value:function e(t,r,n,i){this.destroyInnerView(i);var a=t.ownerDocument.createTextNode("".concat(n));t.replaceWith(a);if(O(i))this.element=a}},{key:"patchFromViewToNode",value:function e(t,r,n,i){this.destroyInnerView(i);var a=this.createNodeElement(t.ownerDocument,n,i);t.replaceWith(a);if(O(i))this.element=a}},{key:"patchFromViewToView",value:function e(t,r,n,i){if(r===n)return;if(C(r,n)&&r.attrs.key===n.attrs.key){var a=this.getInstantiatedView(i);a.update(n.attrs,n.children)}else{this.destroyInnerView(i);var o=this.instantiateInnerView(n,i);var s=Array.from(t.parentNode.childNodes).findIndex(function(e){return e===t});var u=t.parentNode;t.remove();o.mount(u,s);if(O(i))this.element=o.element}}},{key:"unmountPatch",value:function e(){this.mounted=false;this.callHook("unmount");this.element=null}},{key:"destroyInnerViews",value:function e(t,r){for(var n in t.children){var i=r.concat([n]);var a=t.children[n];if(N(a))this.destroyInnerView(i);else if(E(a))this.destroyInnerViews(a,i)}}},{key:"destroyInnerView",value:function e(t){var r=this.getInstantiatedView(t);r.destroy(false);this.removeInstantiatedView(t)}},{key:"createNodeElement",value:function e(t,r,n){var i;if(this.renderingContext.isSvg)i=t.createElementNS("http://www.w3.org/2000/svg",r.tag);else i=t.createElement(r.tag);this.refreshAttributes(i,r,n);this.refreshChildren(i,r,n);return i}},{key:"mountNodeElement",value:function e(t,r,n,i){var a=t.ownerDocument;var o;if(this.renderingContext.isSvg)o=a.createElementNS("http://www.w3.org/2000/svg",n.tag);else o=a.createElement(n.tag);this.refreshAttributes(o,n,i);var s=t.childNodes[r]||null;t.insertBefore(o,s);this.refreshChildren(o,n,i,true);return o}},{key:"refreshAttributes",value:function e(t,r,n){for(var i in r.attrs){var a=r.attrs[i];this.addAttribute(t,i,a,n)}}},{key:"updateAttributes",value:function e(t,r,n,i){if(r===n)return;for(var a in n.attrs){var o=n.attrs[a];if(a in r.attrs){var s=r.attrs[a];this.updateAttribute(t,a,s,o,i)}else this.addAttribute(t,a,o,i)}for(var u in r.attrs){if(!(u in n.attrs))this.removeAttribute(t,u,r.attrs[u],i)}}},{key:"addAttribute",value:function e(t,r,n,i){if(r==="style"){for(var a in n){this.setStyleProp(t,a,n[a]||"")}}else if(n instanceof Function)this.addEventListener(t,T(r),n);else if(S(n)){var o=this.createParametrizedListener(n[0],n[1],i,r);var s=T(r);this.addEventListener(t,s,o)}else if(r==="data"&&n!=null&&y(n)==="object"){for(var u in n){t.dataset[u]=n[u]}}else if(r!=="focus"&&r in t&&!this.renderingContext.isSvg&&n!=null)t[r]=n;else if(typeof n==="boolean"){if(r==="focus"&&t.focus&&t.blur){if(n)t.focus();else t.blur()}else t.setattribute(r,r)}else if(n!=null)t.setAttribute(r,n)}},{key:"updateAttribute",value:function e(t,r,n,i,a){if(n===i)return;if(P(n,i))return;if(r==="style"){for(var o in n){if(!(o in i))this.removeStyleProp(t,o)}for(var s in i){var u=i[s]||"";this.setStyleProp(t,s,u)}}else if(i instanceof Function){this.removeAttribute(t,r,n,a);this.addAttribute(t,r,i,a)}else if(S(i)){this.removeAttribute(t,r,n,a);this.addAttribute(t,r,i,a)}else if(r==="data"){var l=n!=null&&y(n)==="object";var f=i!=null&&y(i)==="object";if(l&&f){for(var c in n){if(!(c in i))delete t.dataset[c]}for(var h in i){t.dataset[h]=i[h]}}else if(l&&!f){for(var v in t.dataset){delete t.dataset[v]}}else if(!l&&f){for(var d in i){t.dataset[d]=i[d]}}}else if(r!=="focus"&&r in t&&!this.renderingContext.isSvg)t[r]=i;else if(typeof n==="boolean"){if(r==="focus"){if(t.focus&&t.blur){if(i)t.focus();else t.blur()}}else{if(i)t.setAttribute(r,r);else t.removeAttribute(r)}}else{if(i!=null)t.setAttribute(r,i);else t.removeAttribute(i)}}},{key:"removeAttribute",value:function e(t,r,n,i){if(r==="style")t.style.cssText="";else if(n instanceof Function){var a=T(r);this.removeEventListener(t,a,n)}else if(S(n)){var o=this.getParametrizedListener(i,r);var s=T(r);this.removeEventListener(t,s,o)}else if(r==="data"&&n!=null&&y(n)==="object"){for(var u in t.dataset){delete t.dataset[u]}}else if(r!=="focus"&&r in t&&!this.renderingContext.isSvg)t[r]=undefined;else if(typeof n==="boolean"){if(r==="focus"&&t.blur)t.blur();else t.removeAttribute(r)}else if(n!=null)t.removeAttribute(r)}},{key:"setStyleProp",value:function e(t,r,n){if(r[0]==="-"){var i=n.indexOf("!important");var a=n;if(i!==-1)a=i!==n.slice(0,i)+n.slice(i+10);a=a.trim().replace(/;$/,"");t.style.setProperty(r,a)}else t.style[r]=n}},{key:"removeStyleProp",value:function e(t,r){if(r[0]==="-")t.style.removeProperty(r);else delete t.style[r]}},{key:"addEventListener",value:function e(i,a,t){if(i.addEventListener)i.addEventListener(a,t);else if(i.attachEvent)i.attachEvent(V(a),t);else{var r=i[a]&&i[a].listeners||[];if(i[a]!=null)i[a].listeners=r.concat(t);else{var n=function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return i[a].listeners.map(function(e){return e.apply(void 0,r)})};n.listeners=r.concat(t);i[a]=n}}}},{key:"removeEventListener",value:function e(t,r,n){if(t.removeEventListener)t.removeEventListener(r,n);else if(t.detachEvent)t.detachEvent(V(r),n);else{if(t[r]!=null&&t[r].listeners!=null)t[r].listeners=t[r].listener.filter(function(e){return e!==n})}}},{key:"refreshChildren",value:function e(t,r,n){var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(!z(r.children))throw new Error("Every view node in an array must have an unique 'key' attribute");for(var a in r.children){var o=r.children[a];var s=n.concat([a]);this.addChildren(t,o,a,s,i)}}},{key:"addChildren",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var i=arguments.length>3?arguments[3]:undefined;var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;if(E(r)){if(a)this.mountNodeElement(t,null,r,i);else{var o=this.createNodeElement(t.ownerDocument,r,i);t.appendChild(o)}}else if(N(r)){var s=this.instantiateInnerView(r,i);s.mount(t,n)}else if(r!=null){var u=t.ownerDocument.createTextNode("".concat(r));t.appendChild(u)}}},{key:"updateChildren",value:function e(t,r,n,i){if(r===n)return;if(!z(n.children))throw new Error("Every view node in an array must have an unique 'key' attribute");var a=Math.max(r.children.length,n.children.length);var o=0;for(var s=0;s<a;s++){var u=t.childNodes[s-o];var l=r.children[s];var f=s in n.children?n.children[s]:null;var c=i.concat([s]);if(l!=null){this.patch(u,l,f,c);if(f==null)o+=1}else{this.addChildren(t,f,s,c);o-=1}}}},{key:"instantiateInnerView",value:function e(t,r){var n=u.getPathKey(r);var i=u.instantiate(t,this.renderingContext);this.innerViews.set(n,{view:i,path:r.slice()});return i}},{key:"getInstantiatedView",value:function e(t){var r=u.getPathKey(t);var n=this.innerViews.get(r);return n!=null?n.view:null}},{key:"removeInstantiatedView",value:function e(t){var r=u.getPathKey(t);this.innerViews.delete(r)}},{key:"getParametrizedListener",value:function e(t,r){var n=u.getAttrKey(t,r);return this.parametrizedEventListeners.get(n)}},{key:"hasParametrizedListener",value:function e(t,r){var n=u.getAttrKey(t,r);return this.parametrizedEventListeners.has(n)}},{key:"createParametrizedListener",value:function e(i,a,t,r){var n=function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}return i.apply(void 0,A(a).concat(r))};var o=u.getAttrKey(t,r);this.parametrizedEventListeners.set(o,n);return n}},{key:"removeParametrizedListeners",value:function e(t,r){for(var n in t.attrs){if(this.hasParametrizedListener(r,n))this.removeParametrizedListener(r,n)}for(var i in t.children){var a=r.concat([i]);var o=t.children[i];if(E(o))this.removeParametrizedListeners(o,a)}}},{key:"removeParametrizedListener",value:function e(t,r){var n=u.getAttrKey(t,r);this.parametrizedEventListeners.delete(n)}}],[{key:"instantiate",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!N(t))throw new Error("View can only be instantiated from view-nodes");return new u(t,r)}},{key:"getPathKey",value:function e(t){return t.join(".")}},{key:"getAttrKey",value:function e(t,r){return"".concat(r,".").concat(u.getPathKey(t))}}]);return u}();var K=function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var i=r;if(E(r))i=b(p(r));var a=t.ownerDocument.defaultView;var o=t instanceof a.SVGElement?j:I;var s=D.instantiate(i,o);s.mount(t,n);return s};var U=function e(r){return function(n){var e;if(n instanceof m)e=n;else if(typeof n==="string")e=p(function(e,t,r){return b(n,e,r)});else e=p(n);var t=r(e);if(t instanceof m)return t;else return p(t)}};t.view=p;t.h=b;t.isElementNode=E;t.isViewNode=N;t.isTextNode=g;t.Node=w;t.mount=K;t.decorator=U});var c=t(f);var h=f.view;var v=f.h;var d=f.isElementNode;var y=f.isViewNode;var m=f.isTextNode;var p=f.Node;var w=f.mount;var g=f.decorator;e.default=c;e.view=h;e.h=v;e.isElementNode=d;e.isViewNode=y;e.isTextNode=m;e.Node=p;e.mount=w;e.decorator=g;Object.defineProperty(e,"__esModule",{value:true})});
